(function(g,k){var a=function(){return new a.fn.init};a.fn=a.prototype={init:function(){return this}};a.api_server="localhost";a.api_port=12072;a.api_version="v1";a.service_version=null;a.file_version="8.40.18";a.service_uptime=0;a.compatible=!1;a.computer_id=null;a.device_id=null;a.games=[];a._readyfunc=[];a._initInterval=0;a._progressInterval=0;a._progressRefCount=0;a._progressDataCache={response_time:0,data:null};a._initialized=!1;a._connmode="jsonp";a._jsonp_uid=0;a.init=function(){document.attachEvent?
(document.attachEvent("onreadystatechange",a._DOMContentLoaded),g.attachEvent("onload",a._initQueryAMInstant)):document.addEventListener&&(document.addEventListener("DOMContentLoaded",a._DOMContentLoaded,!1),g.addEventListener("load",a._initQueryAMInstant,!1))};a._DOMContentLoaded=function(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",a._DOMContentLoaded,!1),a._initQueryAMInstant()):document.attachEvent&&document.readyState==="complete"&&(document.detachEvent("onreadystatechange",
a._DOMContentLoaded),a._initQueryAMInstant())};a._initQueryAMInstant=function(){if(!(a._initialized||a._initQueryAMInstant===null))a._initQueryAMInstant=null,a.serviceQuery("init",{},a.onInit),a.serviceQuery("init",{api_port:27021},a.onInit)};a.onInit=function(b){if(!a._initialized)if(a._initialized=!0,a.service_version=b.service_version,a.api_port=b.api_port,a.service_uptime=b.uptime,a.computer_id=b.computer_id,a.device_id=b.user_id?b.user_id:b.device_id,parseInt(a.api_version.substr(1))>parseInt(b.api_version.substr(1))){if(a._initInterval==
0)a._initInterval=setInterval(function(){a.init()},3E4)}else a.compatible=!0,clearInterval(a._initInterval),b=function(){var b=a._readyfunc;a._readyfunc=[];for(var d=0;d<b.length;d++)b[d].call(a,a.compatible)},b(),setInterval(b,1E3),a.serviceQueryEx("ajax","init",{},function(){a._connmode="ajax"})};a.isServiceCompatible=function(){return a.compatible==!0};a.isServiceInstalled=function(){return a.service_version!=null};a.install=function(b,c){typeof b==="string"&&(b=JSON.parse(b));a.serviceQuery("install",
b,c)};a.preload=function(b,c){typeof b==="string"&&(b=JSON.parse(b));a.serviceQuery("preload",b,c)};a.uninstall=function(b,c){a.serviceQuery("uninstall",{content_id:b},c)};a.play=function(){a.serviceQuery("play",{content_id:arguments[0],auth_token:arguments[1],player_id:arguments[2],game_id:arguments[3],is_trial:arguments[4]},arguments.length>4?arguments[5]:null)};a.listGames=function(){var b=null,c=!1;arguments.length>1?(c=arguments[0],b=arguments[1]):b=arguments[0];a.serviceQuery("listGames",{include_uninstalled:c},
b)};a.listInstallations=function(b){a.serviceQuery("listInstallations",{},b)};a.onInstallationProgress=function(b,c,d){if(typeof d==="function"){a._startQueryInstallationProgress();c=c||1E3;c<250&&(c=250);var e=(new Date).getTime(),i=setInterval(function(){if(!(a._progressDataCache.response_time<e)){var c=a._progressDataCache.data,h={count:0,error:c.error||null,installations:[]};if(c&&c.installations)for(var f=c.installations.length-1;f>=0;--f)(!b||c.installations[f].content_id==b)&&h.installations.push(c.installations[f]);
c=!0;for(f=h.installations.length-1;f>=0;--f){if(h.installations[f].status==="uninitialized"||h.installations[f].status==="installing"||h.installations[f].status==="stopped")c=!1;h.installations[f].status==="uninitialized"&&h.installations.splice(f,1)}(new Date).getTime()-a._progressDataCache.response_time>15E3&&(c=!0);h.count=h.installations.length;if(h.count>0)try{d(h)===!1&&(c=!0)}catch(g){}c&&(clearInterval(i),a._stopQueryInstallationProgress())}}.bind(a),c);return i}};a.onPlayFinished=function(b,
c){a._events.onplayfinished[b]||(a._events.onplayfinished[b]=!0,a.serviceQuery("getGameInfo",{content_id:b,filter:"info"},function(d){if(d.error==null&&d.game_info.running)var e=setInterval(function(){a.serviceQuery("getGameInfo",{content_id:b,filter:"info"},function(d){d.error!=null?(clearInterval(e),a._events.onplayfinished[b]=!1,c({error:d.error})):d.game_info.running==!1&&(clearInterval(e),a._events.onplayfinished[b]=!1,c({total_executions:d.game_info.stats.total_executions,total_execution_time:d.game_info.stats.total_execution_time,
total_execution_trial_time:d.game_info.stats.total_execution_trial_time,execution_result:d.game_info.last_execution_result,error:d.error}))})},2E3);else a._events.onplayfinished[b]=!1,c({error:d.error?d.error:"game_not_launched"})}))};a._events={onplayfinished:{}};a._startQueryInstallationProgress=function(){if(a._progressInterval==0)a._progressInterval=setInterval(function(){a.listInstallations(function(b){a._progressDataCache={response_time:(new Date).getTime(),data:b}})},500);a._progressRefCount++};
a._stopQueryInstallationProgress=function(){if(a._progressInterval!=0&&(a._progressRefCount--,a._progressRefCount==0))clearInterval(a._progressInterval),a._progressInterval=0};a.getInfo=function(b){a.serviceQuery("getInfo",{},b)};a.setSettings=function(b,c){a.serviceQuery("setSettings",b,c)};a.serviceQuery=function(b,c,d){c=c||{};return a.serviceQueryEx(a._connmode,b,c,d)};a.serviceQueryEx=function(b,c,d,e){var i=(new Date).getTime(),g=d.api_port||a.api_port;d.query_id=i;c="http://"+a.api_server+
":"+g+"/"+a.api_version+"/"+c;b=="ajax"?a.ajax(c+".json",e,d):a.jsonp(c+".js",e,d);return""+i};a.jsonp=function(b,c,d){d=d||{};var e=document.getElementsByTagName("head")[0]||document.documentElement,i="__jsonp_"+ ++a._jsonp_uid,j=document.createElement("script");j.type="text/javascript";e.appendChild(j);g[i]=function(a){c&&c(a);g[i]=null;try{delete g[i]}catch(b){}e&&j.parentNode&&e.removeChild(j)};d.callback=i;d=a.serialize(d);j.src=b+(d.length>0?"?"+d:"");return this};a.ajax=function(b,c,d){var e=
{};d=a.serialize(d||"");e.r=null;try{if(g.XDomainRequest)e.r=new XDomainRequest,e.r.onprogress=function(){},e.r.onload=function(){var a=e.r.responseText;if("js".charAt(0)=="x")a=e.r.responseXML;"js".charAt(0)=="j"&&(a=(new Function("return "+a.replace(/[\n\r]/g,"")))());c&&c(a)};else if(g.XMLHttpRequest)e.r=new XMLHttpRequest,e.r.onreadystatechange=function(){if(e.r.readyState==4&&e.r.status==200){var a=e.r.responseText;if("js"[0]=="x")a=e.r.responseXML;"js"[0]=="j"&&(a=(new Function("return "+a.replace(/[\n\r]/g,
"")))());typeof c==="function"&&c(a)}};else return this}catch(i){return this}b+=d.length>0?"?"+d:"";d="";try{e.r.open("GET",b,!0),e.r.send(d)}catch(j){}return this};a.serialize=function(a){var c,d="";if(typeof a!="object")return a;for(c in a)d+="&"+encodeURIComponent(c)+"="+encodeURIComponent(a[c]);return d.substr(1)};a.ready=function(b){a._readyfunc[a._readyfunc.length]=b};a.fn.init.prototype=a.fn;g[k]=a;a.init()})(window,"aminstant");
