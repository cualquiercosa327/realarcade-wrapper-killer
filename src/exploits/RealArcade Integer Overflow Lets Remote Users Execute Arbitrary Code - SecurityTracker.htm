<!DOCTYPE html PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta http-equiv="expires" content="Mon, 01 Jan 2000 00:00:00 GMT">
<meta http-equiv="pragma" content="no-cache">
<meta name="author" content="SecurityTracker">
<meta name="robots" content="follow, index">
<meta name="description" content="Luigi Auriemma reported some vulnerabilities in RealArcade.  A remote user can execute arbitrary code on the target user's system.  A remote user can also cause arbitrary files to be deleted.">
<meta name="keywords" content="RealNetworks, RealArcade">
<title>RealArcade Integer Overflow Lets Remote Users Execute Arbitrary Code - SecurityTracker</title>
<script src="RealArcade%20Integer%20Overflow%20Lets%20Remote%20Users%20Execute%20Arbitrary%20Code%20-%20SecurityTracker_files/ga.js" async="" type="text/javascript"></script><script src="RealArcade%20Integer%20Overflow%20Lets%20Remote%20Users%20Execute%20Arbitrary%20Code%20-%20SecurityTracker_files/ga.js" async="" type="text/javascript"></script><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-483172-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>
<body bgcolor="#FFFFFF">
 
<a name="top">
 
<!-- SecurityTracker Headlines Copyright 2013 by SecurityGlobal.net LLC -->

</a><a name="top">

<!-- build table for top logo header -->

<center><table cellpadding="2" width="93%"><tbody><tr><td width="55%">
<center><a href="http://securitytracker.com/"><img src="RealArcade%20Integer%20Overflow%20Lets%20Remote%20Users%20Execute%20Arbitrary%20Code%20-%20SecurityTracker_files/securitytracker_194x60.gif" title="SecurityTracker.com" alt="SecurityTracker.com" border="0" height="60" width="194"></a></center></td>
<td nowrap="nowrap"><center><font face="Arial, Helvetica"><font size=""><b>Keep Track of the <i>Latest</i> Vulnerabilities<br>with SecurityTracker!</b></font></font>
</center></td><td></td></tr><tr><td height="5"></td></tr></tbody></table></center>

<!-- build color site navigation bar -->

<font link="#999999" vlink="#999999" alink="#999999">
</font><table cols="1" bgcolor="#000080" cellpadding="1" cellspacing="0" width="100%"><tbody><tr><td nowrap="nowrap"><font face="Arial, Helvetica"><font size="-1">&nbsp;&nbsp;&nbsp;<b>
<a style="color:#FFFFFF;text-decoration:none;" href="http://securitytracker.com/" title="Go to the SecurityTracker Home Page">
<font color="#ECECDC">Home</font>
</a>&nbsp;&nbsp;&nbsp;<font color="#FFFFFF">|</font>&nbsp;&nbsp;&nbsp;
<a style="color:#FFFFFF;text-decoration:none;" href="http://securitytracker.com/topics/topics.html" title="View the Vulnerability Topic Categories">
<font color="#ECECDC">View Topics</font>
</a>&nbsp;&nbsp;&nbsp;<font color="#FFFFFF">|</font>&nbsp;&nbsp;&nbsp;
<a style="color:#FFFFFF;text-decoration:none;" href="http://securitytracker.com/search/search.html" title="Search the Vulnerability Alerts">
<font color="#ECECDC">Search</font>
</a>&nbsp;&nbsp;&nbsp;<font color="#FFFFFF">|</font>&nbsp;&nbsp;&nbsp;
<a style="color:#FFFFFF;text-decoration:none;" href="http://securitytracker.com/help/contacts.html" title="Contact Us ">
<font color="#ECECDC">Contact Us</font>

<!-- 
</a>&nbsp;&nbsp;&nbsp;<FONT COLOR="#FFFFFF">|</FONT>&nbsp;&nbsp;&nbsp;

<a style="color:#ECECDC;text-decoration:none;" href="/help/1.html" title="View the Help Menu">
<FONT COLOR="#ECECDC">Help</FONT>
-->

</a>&nbsp;&nbsp;&nbsp;<font color="#FFFFFF">|</font>&nbsp;&nbsp;&nbsp;
</b></font></font></td></tr>
</tbody></table>

<!-- end of color site navigation bar -->

 
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-483172-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
 
<!-- table for date and sponsorship -->
 
<table>
<tbody><tr>
<td></td>
</tr>
<tr>
<td valign="top">
<table border="0" cellpadding="0" cellspacing="0" width="120">
<tbody><tr><td valign="top"><center>
<font face="Arial, Helvetica" size="-1">
<br><b><i>Security</i>Tracker<br>Archives<br></b>

</font></center></td>
</tr></tbody></table>
 
</td>
<!-- spacer columns -->
<td><br></td>
<td><br></td>
 
<td align="center" valign="top" width="100%">
<table cellpadding="0" cellspacing="0" width="75%">
<tbody><tr>
<td valign="top"><center>
<!-- SP1 -->
 
</center></td>
<td>&nbsp;</td>
<td valign="top"><center>

<script type="text/javascript"><!--
google_ad_client = "ca-pub-0341887015237300";
/* 468x60, created 3/26/10 */
google_ad_slot = "5483000581";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript" src="RealArcade%20Integer%20Overflow%20Lets%20Remote%20Users%20Execute%20Arbitrary%20Code%20-%20SecurityTracker_files/show_ads.js">
</script>

</center></td>
</tr></tbody></table>
 
</td>
</tr>
</tbody></table>
 
<!-- end of date and sponsorship section -->
 
<!-- begin main section -->
 
<table>
<tbody><tr>
<td valign="top">
 
<!-- build left hand navigation column  -->

 
<font link="#ECECDC" vlink="#ECECDC" alink="#ECECDC">
 
</font><table border="0" cellpadding="0" cellspacing="0" width="120">
<tbody><tr><td>
 
<table bgcolor="#660066" border="0" cellpadding="0" cellspacing="0" width="122">
<tbody><tr><td align="center"><font face="Arial, Helvetica">
<a style="color:#FFFFFF;text-decoration:none;" href="http://securitytracker.com/signup/signup_now.html" title="Sign Up for Free Alerts">
<font color="#ECECDC" size="-1">
<b>Sign Up</b></font></a></font></td></tr></tbody></table>
<table bgcolor="660066" border="0" cellpadding="1" cellspacing="0" width="120">
<tbody><tr><td><table bgcolor="CCCC99" border="0" cellpadding="5" cellspacing="0" width="120">
<tbody><tr><td align="center"><font color="#000000" face="Arial, Helvetica" size="-2">
Sign Up for Your <font color="#DC143C"><b>FREE</b></font> Weekly SecurityTracker E-mail Alert Summary

<br></font>
</td></tr></tbody></table>
</td></tr></tbody></table>
 
</td></tr>
 
<tr><td bgcolor="#FFFFFF" height="8"></td></tr>
 
<tr><td>
 
<table bgcolor="#660066" border="0" cellpadding="0" cellspacing="0" width="122">
<tbody><tr><td align="center"><font face="Arial, Helvetica">
<!-- <a style="color:#FFFFFF;text-decoration:none;" href="/server/info?5421+learn/premium.html" title="Buy Our Premium Service"> -->
<a style="color:#FFFFFF;text-decoration:none;" href="" title="Buy Our Premium Service">
<font color="#ECECDC" size="-1">
<b>Instant Alerts</b></font></a></font></td></tr></tbody></table>
<table bgcolor="660066" border="0" cellpadding="1" cellspacing="0" width="120">

<tbody><tr><td><table bgcolor="CCCC99" border="0" cellpadding="5" cellspacing="0" width="120">
<tbody><tr><td align="center"><font color="#000000" face="Arial, Helvetica" size="-2">
<!-- Buy our <a href="/server/info?5420+learn/premium.html">Premium Vulnerability Notification Service</a> to receive customized, instant alerts -->
Buy our <a href="http://securitytracker.com/learn/premium.html">Premium Vulnerability Notification Service</a> to receive customized, instant alerts
<br></font>
</td></tr></tbody></table>
</td></tr></tbody></table>
 
</td></tr>
 
<tr><td bgcolor="#FFFFFF" height="8"></td></tr>
 
<tr><td>
 
<table bgcolor="#660066" border="0" cellpadding="0" cellspacing="0" width="122">

<tbody><tr><td align="center"><font face="Arial, Helvetica">
<a style="color:#FFFFFF;text-decoration:none;" href="http://securitytracker.com/affiliate/affiliate_signup.html" title="Join Our Affiliate Program">
<font color="#ECECDC" size="-1">
<b>Affiliates</b></font></a></font></td></tr></tbody></table>
<table bgcolor="660066" border="0" cellpadding="1" cellspacing="0" width="120">
<tbody><tr><td><table bgcolor="CCCC99" border="0" cellpadding="5" cellspacing="0" width="120">
<tbody><tr><td align="center"><font color="#000000" face="Arial, Helvetica" size="-2">
Put SecurityTracker Vulnerability Alerts on Your Web Site -- It's Free!
<br></font>
</td></tr></tbody></table>
</td></tr></tbody></table>
 
</td></tr>
 
<tr><td bgcolor="#FFFFFF" height="8"></td></tr>
 

<tr><td>
 
<table bgcolor="#660066" border="0" cellpadding="0" cellspacing="0" width="122">
<tbody><tr><td align="center"><font face="Arial, Helvetica">
<!-- <a style="color:#FFFFFF;text-decoration:none;" href="/learn/partners.html" title="Become a Partner"> -->
<a style="color:#FFFFFF;text-decoration:none;" href="" title="Become a Partner">
<font color="#ECECDC" size="-1">
<b>Partners</b></font></a></font></td></tr></tbody></table>
<table bgcolor="660066" border="0" cellpadding="1" cellspacing="0" width="120">
<tbody><tr><td><table bgcolor="CCCC99" border="0" cellpadding="5" cellspacing="0" width="120">
<tbody><tr><td align="center"><font color="#000000" face="Arial, Helvetica" size="-2">
<!-- Become a Partner and <a href="/learn/partners.html">License</a> Our Database or Notification Service -->
Become a Partner and <a href="">License</a> Our Database or Notification Service
<br></font>
</td></tr></tbody></table>

</td></tr></tbody></table>
 
</td></tr>
 
<tr><td bgcolor="#FFFFFF" height="8"></td></tr>
 
<tr><td>
 
<table bgcolor="#660066" border="0" cellpadding="0" cellspacing="0" width="122">
<tbody><tr><td align="center"><font face="Arial, Helvetica">
<!-- <a style="color:#FFFFFF;text-decoration:none;" href="/help/submitting.html" title="Report a Vulnerability"> -->
<a style="color:#FFFFFF;text-decoration:none;" href="" title="Report a Vulnerability">
<font color="#ECECDC" size="-1">
<b>Report a Bug</b></font></a></font></td></tr></tbody></table>
<table bgcolor="660066" border="0" cellpadding="1" cellspacing="0" width="120">
<tbody><tr><td><table bgcolor="CCCC99" border="0" cellpadding="5" cellspacing="0" width="120">
<tbody><tr><td align="center"><font color="#000000" face="Arial, Helvetica" size="-2">

Report a vulnerability that you have found to SecurityTracker<br><a href="mailto:bugs@securitytracker.com">bugs<br>@<br>securitytracker.com</a>
<br></font>
</td></tr></tbody></table>
</td></tr></tbody></table>
 
</td></tr>
 
<tr><td bgcolor="#FFFFFF" height="8"></td></tr>
 
<tr><td></td></tr>
 
<tr><td></td></tr>
 
<tr><td><center><font face="Arial, Helvetica" size="-2">
<br><br>
</font></center><br></td></tr>
 

</tbody></table>
 
<!-- end of left hand column -->
 
 
</td>
<!-- spacer columns -->
<td><br></td>

<td><br></td>
 
<td valign="top">
 
<!-- divider line -->
 
<table cellpadding="0" cellspacing="0" width="100%">
<tbody><tr height="2"><td bgcolor="#FFFFFF" height="2"><spacer type="block" width="1" height="1"></spacer></td></tr>
<tr height="1"><td bgcolor="#CCCCCC" height="1"><spacer type="block" width="1" height="1"></spacer></td></tr>
<tr height="4"><td bgcolor="#FFFFFF" height="4"><spacer type="block" width="1" height="1"></spacer></td></tr>
</tbody></table>
 
<!-- MSG -->
 
<table width="100%">
<tbody><tr>
<td valign="top">

<font face="Arial, Helvetica" size="-2">
Category:&nbsp;&nbsp;
<a href="http://securitytracker.com/archives/category/1633.html">Application (Game)</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;
<a href="http://securitytracker.com/archives/target/6952.html">RealArcade</a></font>
</td>
 
<td align="right"><font face="Arial, Helvetica" size="-2">
Vendors:&nbsp;&nbsp;
<a href="http://securitytracker.com/archives/vendor/1597.html">RealNetworks</a></font>
</td>
</tr>
</tbody></table>
 

<!-- build table for message contents -->
 
<table width="100%">
<tbody><tr>
<td valign="top">
<font face="Arial, Helvetica" size="+2">
<b>RealArcade Integer Overflow Lets Remote Users Execute Arbitrary Code</b>
</font><br></td></tr>
 
<tr><td>
<font face="Arial, Helvetica" size="-1">
<b>SecurityTracker Alert ID:</b>&nbsp;&nbsp;1013128</font></td></tr>

<tr><td>
<font face="Arial, Helvetica" size="-1">
<b>SecurityTracker URL:</b>&nbsp;&nbsp;http://securitytracker.com/id/1013128 
</font></td></tr>
<tr><td><font face="Arial, Helvetica" size="-1">
<b>CVE Reference:</b>&nbsp;&nbsp;
<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=GENERIC-MAP-NOMATCH" target="_blank">GENERIC-MAP-NOMATCH</a>
&nbsp;&nbsp;<font size="-2"><i>(Links to External Site)</i></font>
 
</font></td></tr>
<tr><td>
<font face="Arial, Helvetica" size="-1">

<b>Date:&nbsp;&nbsp;</b>Feb  9 2005
</font><br></td></tr>
 
<tr><td>
<font face="Arial, Helvetica" size="-1">
<b>Impact:</b>&nbsp;&nbsp;
<a href="http://securitytracker.com/archives/impact/149.html">Execution of arbitrary code via network</a>, <a href="http://securitytracker.com/archives/impact/21.html">Modification of system information</a>, <a href="http://securitytracker.com/archives/impact/22.html">Modification of user information</a>, <a href="http://securitytracker.com/archives/impact/24.html">User access via network</a></font><br></td></tr>
 
<tr><td>
<font face="Arial, Helvetica" size="-1">
</font><br></td></tr>
 
<tr><td><font face="Arial, Helvetica" size="-1">
<b>Version(s):</b> 1.2.0.994 and prior versions</font><br></td></tr>
 
<tr><td><font face="Arial, Helvetica" size="-1">
<b>Description:</b>&nbsp;&nbsp;
Luigi Auriemma reported some vulnerabilities in RealArcade.  A remote 
user can execute arbitrary code on the target user's system.  A remote 
user can also cause arbitrary files to be deleted.<br><br>
The software does not properly process RGS files.  A remote user can 
create an RGS file with a specially crafted size value for the GUID and 
game name string to trigger an integer overflow.  A remote user can 
execute arbitrary code on the target user's system.  A demonstration 
exploit is available at:<br>
<br>
http://aluigi.altervista.org/poc/rna_bof.rgs<br>
<br>
A remote user can create an RGP file with a specially crafted 'FILENAME'
 tag to cause a specified file on the target user's system to be 
deleted.<br>
<br>
A demonstration exploit value is provided:<br>
<br>
   &lt;FILENAME&gt;../../windows/calc.exe&lt;/FILENAME&gt;<br>
<br>
A demonstration exploit [to delete '../../../../../../folder/myfile.txt'] is available at:<br>
<br>
http://aluigi.altervista.org/poc/rna_deleter.rgp<br>
<br>
The vendor was notified on October 31, 2004.</font><br></td></tr>
 
<tr><td><font face="Arial, Helvetica" size="-1">
<b>Impact:</b>&nbsp;&nbsp;
A remote user can cause arbitrary code to be executed on the target user's system with the privileges of the target user.<br>
<br>
A remote user can cause arbitrary files to be deleted.</font><br></td></tr>
 
<tr><td><font face="Arial, Helvetica" size="-1">
<b>Solution:</b>&nbsp;&nbsp;
No solution was available at the time of this entry.</font><br></td></tr>

<tr><td><font face="Arial, Helvetica" size="-1">
<b>Vendor URL:</b>&nbsp;&nbsp;<a href="http://www.realarcade.com/" target="_blank">www.realarcade.com/</a> <font size="-2"><i>(Links to External Site)</i></font>
</font><br></td></tr>
 
<tr><td><font face="Arial, Helvetica" size="-1">
<b>Cause:</b>&nbsp;&nbsp;
<a href="http://securitytracker.com/archives/cause/27.html">Boundary error</a>, <a href="http://securitytracker.com/archives/cause/30.html">Input validation error</a></font><br></td></tr>
 
<tr><td>
<font face="Arial, Helvetica" size="-1">
<b>Underlying OS:</b>&nbsp;&nbsp;
<a href="http://securitytracker.com/archives/underlyingos/218.html">Windows (Any)</a></font><br></td></tr>
 

<tr><td><font face="Arial, Helvetica" size="-1">
</font><br></td></tr>
 
<tr><td><font face="Arial, Helvetica" size="-1">

<b>Message History:</b>
 
&nbsp;&nbsp;None.
<!-- no_history -->


</font><br></td></tr>
 
<tr><td><br><hr size="1">
 
<center><font face="Arial, Helvetica" size="-1">
<img src="RealArcade%20Integer%20Overflow%20Lets%20Remote%20Users%20Execute%20Arbitrary%20Code%20-%20SecurityTracker_files/small-st.jpg" align="absmiddle">
&nbsp;<b>Source Message Contents</b><br></font></center>
<hr size="1"></td></tr>


<tr><td><font face="Arial, Helvetica" size="-1">

<b>Date: </b><font face="Courier, New Courier">&nbsp;Tue, 8 Feb 2005 18:52:57 +0000</font><br>
<b>Subject: </b><font face="Courier, New Courier">&nbsp;Integer overflow and arbitrary files deletion in RealArcade</font><br>
</font></td></tr>
 
<tr><td><br>
<font size="-1">
<pre>

#######################################################################

                             Luigi Auriemma

Application:  RealArcade
              http://www.realarcade.com
Versions:     &lt;= 1.2.0.994
Platforms:    Windows
Bugs:         A] integer overflow in RGS files
              B] arbitrary files deletion through RGP files
Exploitation: local (or remote through browser)
Date:         08 Feb 2005
Author:       Luigi Auriemma
              e-mail: aluigi@autistici.org
              web:    http://aluigi.altervista.org


#######################################################################


1) Introduction
2) Bugs
3) The Code
4) Fix


#######################################################################

===============
1) Introduction
===============


RealArcade is a software/portal developed by RealNetworks for
downloading and buying arcade games.


#######################################################################

=======
2) Bugs
=======


--------------------------------
A] integer overflow in RGS files
--------------------------------

The problem is located in the handling of the RGS files, in fact exists
an integer overflow in the 32 bits value that specifies the size of the
text string containg the GUID and the name of the game to install.

When the user launchs a RGS file he can choose if continuing to install
it or not.
The bug happens with both the choices overwriting the return address of
the vulnerable function and letting the attacker to execute malicious
code on the victim.


---------------------------------------------
B] arbitrary files deletion through RGP files
---------------------------------------------

The second problem instead lets an attacker to delete any file in the
victim's disk simply using a RGP file containing a &lt;FILENAME&gt; tag 
followed by a filename with a directory traversal path just like this
piece of RGP file:

...
			&lt;GAMEID&gt;950258D1-7ABD-4afc-8886-449B98CE8224&lt;/GAMEID&gt;
			&lt;VERSION&gt;1.0 Demo RGI&lt;/VERSION&gt;
			&lt;TYPE&gt;demo&lt;/TYPE&gt;
			&lt;GENRE&gt;Puzzle and Board&lt;/GENRE&gt;

              &lt;!-- now we exploit the directory traversal bug --&gt;

			&lt;FILENAME&gt;../../windows/calc.exe&lt;/FILENAME&gt;
...

To be exact the problem is in the first operation made on the file when
RealArcade searchs for an existent file with the same name and deletes
it immediately (both if it already exists or not).
Instead in the next step (the downloading of the file from the web)
everything works correctly, that's why is only possible to delete a
local file and not to overwrite it with a malicious one causing more
damage.

The exploitation is immediate, so a simple double-click on a local RGP
file leads to the instantaneous deletion of the file without warnings
or confirmations.

An useless note about the usage of a slash or a backslash for the
exploitation: seems that in older versions also the backslash had the
same effect while in the recent vulnerable versions only the slash is
allowed.


#######################################################################

===========
3) The Code
===========


A] http://aluigi.altervista.org/poc/rna_bof.rgs

B] http://aluigi.altervista.org/poc/rna_deleter.rgp

   this second proof-of-concept overwrites the following file:

     ../../../../../../folder/myfile.txt (usually c:\folder\myfile.txt)

   So you must have or create this file and this folder to be able to
   see the effect of the exploitation.


#######################################################################

======
4) Fix
======


No fix.
A patch will be "probably" released the 10th February but I doubt since
it's from the beginning of January that each week the developers say
that they will release the patch the "next week".

In any case I reported the bugs to them exactly the 31th October 2004
(so over 3 months ago) and I'm sorry to have not fully respected my
policy since this advisory should be released at least 2 months ago
avoiding all this horrible and shameful wasting of time made by the
developers.


#######################################################################


--- 
Luigi Auriemma
http://aluigi.altervista.org
 
 
</pre>
</font></td></tr>
 
<tr><td width="800"></td></tr>

 
</tbody></table>
 
<br><br>
<font face="Arial, Helvetica" size="-2">
<b><center><a href="#top">Go to the Top of This <i>Security</i>Tracker Archive Page</a></center></b></font>
<br><a name="bottom"><hr size="1">
 
</a></td></tr></tbody></table>
 
<!-- end of main section -->
 
<br><br><br>
 
<!-- build simple site navigation bar -->

</a><center><a name="top"><font face="Arial, Helvetica"><font size="-1">
</font></font></a><font face="Arial, Helvetica"><font size="-1"><a href="http://securitytracker.com/">Home</a>&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
<a href="http://securitytracker.com/topics/topics.html">View Topics</a>&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
<a href="http://securitytracker.com/search/search.html">Search</a>&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
<a href="http://securitytracker.com/help/contacts.html">Contact Us</a>
<!-- 
&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
<a href="/help/1.html">Help</a> -->
</font></font></center>
<br>


<!-- This page is copyright 2013 by SecurityGlobal.net LLC -->

<center><font face="Arial, Helvetica" size="-2">Copyright 2013, SecurityGlobal.net LLC</font></center>






</body><!-- end --></html>